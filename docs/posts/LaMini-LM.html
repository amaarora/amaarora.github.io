<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aman Arora">
<meta name="dcterms.date" content="2025-04-04">
<meta name="description" content="As part of this blog post, we regenerate a small sample of the 2.58M shared Instruction Dataset and also perform human evaluation on some of the generated models shared in the research paper.">

<title>Paper Review - ‘LaMini-LM’</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-158677010-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Paper Review - ‘LaMini-LM’">
<meta name="twitter:description" content="As part of this blog post, we regenerate a small sample of the 2.58M shared Instruction Dataset and also perform human evaluation on some of the generated models shared in the research paper.">
<meta name="twitter:image" content="../images/lamini-lm.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Aman Arora’s Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/amaarora"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/amaarora"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Paper Review - ‘LaMini-LM’</h1>
            <p class="subtitle lead">Paper review of “LaMini-LM - A Diverse Herd of Distilled Models from Large-Scale Instructions” and analysis on released 2.58M instruction dataset.</p>
                  <div>
        <div class="description">
          <p>As part of this blog post, we regenerate a small sample of the 2.58M shared Instruction Dataset and also perform human evaluation on some of the generated models shared in the research paper.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Large Language Models</div>
                <div class="quarto-category">Paper Review</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aman Arora </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 4, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#dataset-generation" id="toc-dataset-generation" class="nav-link" data-scroll-target="#dataset-generation"><span class="toc-section-number">2</span>  Dataset Generation</a>
  <ul class="collapse">
  <li><a href="#example-guided" id="toc-example-guided" class="nav-link" data-scroll-target="#example-guided"><span class="toc-section-number">2.1</span>  Example Guided</a></li>
  <li><a href="#topic-guided" id="toc-topic-guided" class="nav-link" data-scroll-target="#topic-guided"><span class="toc-section-number">2.2</span>  Topic Guided</a></li>
  <li><a href="#response-generation" id="toc-response-generation" class="nav-link" data-scroll-target="#response-generation"><span class="toc-section-number">2.3</span>  Response Generation</a></li>
  </ul></li>
  <li><a href="#dataset-exploration" id="toc-dataset-exploration" class="nav-link" data-scroll-target="#dataset-exploration"><span class="toc-section-number">3</span>  Dataset Exploration</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>As part of this blog post, we will be looking at the <a href="https://arxiv.org/abs/2304.14402">LaMini-LM: A Diverse Herd of Distilled Models from Large-Scale Instructions</a> (<span class="citation" data-cites="laminilm">Wu et al. (<a href="#ref-laminilm" role="doc-biblioref">2023</a>)</span>) paper released day before on Apr 27, 2023.</p>
<p>The main objectives of this blog post are:</p>
<ol type="1">
<li><em>To provide a thorough review of the LaMini-LM paper released yesterday.</em></li>
<li><em>We will try to replicate most figures and share commentary on why some of the results might me misleading.</em></li>
<li><em>Recreate a small sample of the 2.58M shared Instruction Dataset to showcase the complete process.</em></li>
<li><em>Compare similarity on generated instructions using sentence embeddings generated by using Sentence Transformer from HuggingFace.</em></li>
<li><em>Share all code in PyTorch that is used as part of this blog post.</em></li>
<li><em>Discuss the limitations of LaMini-LMs.</em></li>
</ol>
<p>As far as I am aware, this blog post is a first of it’s kind. While I have provided paper summaries before along with PyTorch code, it’s the first time that I will be doing a paper review. With that being said, let’s get started with the dataset generation.</p>
</section>
<section id="dataset-generation" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="dataset-generation"><span class="header-section-number">2</span> Dataset Generation</h2>
<p>The authors have generated a large set of 2.58M instruction+response dataset using <code>gpt-3.5-turbo</code> (ChatGPT). At the time of writing I believe this is the biggest Instruction dataset available.</p>
<p>From the paper:</p>
<p><em>We collate instructions from various prior datasets such as self-instruct (<span class="citation" data-cites="selfinstruct">Wang et al. (<a href="#ref-selfinstruct" role="doc-biblioref">2022</a>)</span>), P3 (<span class="citation" data-cites="p3">Sanh et al. (<a href="#ref-p3" role="doc-biblioref">2021</a>)</span>), FLAN (<span class="citation" data-cites="flan">Longpre et al. (<a href="#ref-flan" role="doc-biblioref">2023</a>)</span>) and Alpaca (<span class="citation" data-cites="alpaca">Taori et al. (<a href="#ref-alpaca" role="doc-biblioref">2023</a>)</span>).</em></p>
<p>This means that the dataset builds on top of existing resources. Below I provide an overview of the existing datasets:</p>
<ol type="1">
<li><strong>Self-Instruct:</strong> Instruction, input, and output samples from a language model (52K)</li>
<li><strong>P3:</strong> P3 (Public Pool of Prompts) is a collection of prompted English datasets covering a diverse set of NLP tasks. Hosted at HuggingFace <a href="https://huggingface.co/datasets/bigscience/P3">here</a>.</li>
<li><strong>FLAN:</strong> Instruction dataset on a wide variety of datasets (473 datasets, 146 task categories, and 1,836 total tasks) using various instruction templates. Refer to the <a href="https://github.com/google-research/FLAN/tree/main/flan/v2">GitHub repo</a> for more details.</li>
<li><strong>Alpaca:</strong> 52K instruction-following demonstrations generated in the style of self-instruct using <code>text-davinci-003</code>.</li>
</ol>
<p>The authors use two strategies to generate instructions on top of existing ones which they called:</p>
<ol type="1">
<li>Example-guided</li>
<li>Topic-guided</li>
</ol>
<p>Let’s look at them in detail in the following sections.</p>
<section id="example-guided" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="example-guided"><span class="header-section-number">2.1</span> Example Guided</h3>
<p>Instruction guided generation follows <span class="citation" data-cites="selfinstruct">Wang et al. (<a href="#ref-selfinstruct" role="doc-biblioref">2022</a>)</span> &amp; <span class="citation" data-cites="alpaca">Taori et al. (<a href="#ref-alpaca" role="doc-biblioref">2023</a>)</span>.</p>
<p>Specifically, the authors include only few random examples, and some limited constraints as shown in the example prompt in <a href="#fig-1">Figure&nbsp;1</a>.</p>
<p>Newer instructions are generated by providing these examples from existing datasets - Self-Instruct (<span class="math inline">\(X_{SI}\)</span>), P3 (<span class="math inline">\(X_{P3}\)</span>) &amp; FLAN (<span class="math inline">\(X_{FLAN}\)</span>). The number of in-context examples used in (<span class="math inline">\(X_{SI}\)</span>) is 3 whereas for <span class="math inline">\(X_{P3}\)</span> &amp; <span class="math inline">\(X_{FLAN}\)</span>, 2 in-context examples are used.</p>
<div id="fig-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../images/lamini-example-guided.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: An example of instruction generation prompt based on three random examples from self-instruct</figcaption><p></p>
</figure>
</div>
<p>To generate your own instructions using ChatGPT, either paste the above prompt in ChatGPT, or we can use the openai API like so:</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openai</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>openai.api_key <span class="op">=</span> <span class="st">"sk_"</span> <span class="co">#Your API key goes here </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>examples <span class="op">=</span> [</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'What are some things you can do to de-stress?'</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'How can individuals and organizations reduce unconscious bias?'</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Write a program to compute the sum of integers from k to n.'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>prompt<span class="op">=</span><span class="ss">f"""</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;example&gt;</span><span class="sc">{</span>examples[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&lt;/example&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;example&gt;</span><span class="sc">{</span>examples[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&lt;/example&gt;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;example&gt;</span><span class="sc">{</span>examples[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">&lt;/example&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="ss">Generate </span><span class="sc">{</span>N<span class="sc">}</span><span class="ss"> diverse examples that are similar to the provided examples.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ss">You do not need to provide a response to the generated examples.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="ss">Each example must include an instruction.</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="ss">Each generated instruction can be either an imperative sentence or a question.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="ss">Each example must start with the label "&lt;example&gt;" and end with the label "&lt;/example&gt;".</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>messages <span class="op">=</span> [{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: prompt}]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> openai.ChatCompletion.create(</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="st">'gpt-3.5-turbo'</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    messages<span class="op">=</span>messages,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span><span class="dv">0</span>, <span class="co"># not specified in the paper </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>response.choices[<span class="dv">0</span>].message[<span class="st">"content"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the above code, you can see how we can easily replace the <code>examples</code> list with a function that looks like - <code>get_random_examples(n=3, subset='self-instruct')</code> and based on that get example instructions from the existing datasets.</p>
<p>Running the above returns an output that looks like:</p>
<pre><code>&lt;example&gt;What are some healthy breakfast options?&lt;/example&gt;
&lt;example&gt;How can you improve your public speaking skills?&lt;/example&gt;
&lt;example&gt;Write a recipe for a vegan lasagna.&lt;/example&gt;
&lt;example&gt;What are some ways to save money on groceries?&lt;/example&gt;
&lt;example&gt;How can you improve your time management skills?&lt;/example&gt;
&lt;example&gt;Write a workout plan for beginners.&lt;/example&gt;
&lt;example&gt;What are some tips for studying effectively?&lt;/example&gt;
&lt;example&gt;How can you improve your writing skills?&lt;/example&gt;
&lt;example&gt;Write a program to find the largest number in an array.&lt;/example&gt;
&lt;example&gt;What are some ways to improve your memory?&lt;/example&gt;
&lt;example&gt;How can you improve your interpersonal communication skills?&lt;/example&gt;
&lt;example&gt;Write a step-by-step guide for making a paper airplane.&lt;/example&gt;
&lt;example&gt;What are some ways to reduce your carbon footprint?&lt;/example&gt;
&lt;example&gt;How can you improve your problem-solving skills?&lt;/example&gt;
&lt;example&gt;Write a program to check if a number is prime.&lt;/example&gt;
&lt;example&gt;What are some ways to improve your creativity?&lt;/example&gt;
&lt;example&gt;How can you improve your leadership skills?&lt;/example&gt;
&lt;example&gt;Write a guide for making homemade soap.&lt;/example&gt;
&lt;example&gt;What are some healthy breakfast options?&lt;/example&gt;
&lt;example&gt;What are some ways to improve your emotional intelligence?&lt;/example&gt;</code></pre>
<p>The instructions that are generated by using examples from <span class="math inline">\(X_{SI}\)</span>, <span class="math inline">\(X_{P3}\)</span> &amp; <span class="math inline">\(X_{FLAN}\)</span> are referred to as <span class="math inline">\(\hat{X_{SI}}\)</span>, <span class="math inline">\(\hat{X_{P3}}\)</span> &amp; <span class="math inline">\(\hat{X_{FLAN}}\)</span>. So, the above 20 generated instructions would be part of <span class="math inline">\(\hat{X_{SI}}\)</span>.</p>
</section>
<section id="topic-guided" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="topic-guided"><span class="header-section-number">2.2</span> Topic Guided</h3>
<p>The process and prompt for topic guided instruction generation is slightly different from example-guided instruction generation.</p>
<p>The overall process for topic-guided generation looks like:</p>
<ol type="1">
<li>Find a list of common categories from Wikipidea (Total 3.5M)</li>
<li>Filter out topics based on two rules.
<ol type="1">
<li>The category must be less than three words.</li>
<li>The category must comprise more than 10 sub-categories and 50 pages.</li>
</ol></li>
</ol>
<p>After filtering, the authors obtain a list of 3.5K categories that serve as common topics.</p>
<div id="fig-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../images/lamini-topic-guided.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: An example of instruction generation prompt based on three random examples from self-instruct and three random topics.</figcaption><p></p>
</figure>
</div>
<div class="cell" data-execution_count="65">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openai</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>openai.api_key <span class="op">=</span> <span class="st">"sk_"</span> <span class="co">#Your API key goes here </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>examples <span class="op">=</span> [</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Try coming up with a creative way to stay motivated during a workout.'</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'In your opinion, what are the qualities of an effective sports coach?'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Return the SSN number for the person: "Yann LeCun"'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>topics <span class="op">=</span> [<span class="st">'Machine Learning'</span>, <span class="st">'Infantry'</span>, <span class="st">'Design bureaus'</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>prompt<span class="op">=</span><span class="ss">f"""</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;example&gt;</span><span class="sc">{</span>examples[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&lt;/example&gt;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;example&gt;</span><span class="sc">{</span>examples[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">&lt;/example&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;example&gt;</span><span class="sc">{</span>examples[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">&lt;/example&gt;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="ss">Generate </span><span class="sc">{</span>N<span class="sc">}</span><span class="ss"> diverse examples that are similar to the provided examples with the topics </span><span class="sc">{</span>topics[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>topics[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>topics[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">".</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="ss">You do not need to provide a response to the generated examples. </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="ss">Each example must include an instruction. Each generated instruction can be either an imperative sentence or a question. </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="ss">Each example must start with the label "&lt;example&gt;" and end with the label "&lt;/example&gt;"."."""</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>messages <span class="op">=</span> [{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: prompt}]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> openai.ChatCompletion.create(</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    model<span class="op">=</span><span class="st">'gpt-3.5-turbo'</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    messages<span class="op">=</span>messages,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    temperature<span class="op">=</span><span class="dv">0</span>, <span class="co"># not specified in the paper </span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(response.choices[<span class="dv">0</span>].message[<span class="st">"content"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As before, we can easily replace the <code>examples</code> list with a function that looks like - <code>get_random_examples(n=3, subset='self-instruct')</code> &amp; also replace <code>topics</code> with a function that looks like - <code>get_random_topics(n=3, subset='wiki-categories')</code>.</p>
<p>Running the above code returns an output that looks like:</p>
<pre><code>&lt;example&gt;What are some common machine learning algorithms and their applications?&lt;/example&gt;
&lt;example&gt;Design a new weapon for the infantry that is both effective and lightweight.&lt;/example&gt;
&lt;example&gt;Retrieve the contact information for a design bureau specializing in sustainable architecture.&lt;/example&gt;
&lt;example&gt;How can machine learning be used to improve healthcare outcomes?&lt;/example&gt;
&lt;example&gt;Create a workout plan for an infantry soldier to improve their endurance and strength.&lt;/example&gt;
&lt;example&gt;What are some key considerations when designing a user interface for a mobile app?&lt;/example&gt;
&lt;example&gt;Find a machine learning library that is compatible with Python.&lt;/example&gt;
&lt;example&gt;Develop a training program for infantry soldiers to improve their marksmanship skills.&lt;/example&gt;
&lt;example&gt;What are some ethical concerns surrounding the use of machine learning in decision-making?&lt;/example&gt;
&lt;example&gt;Design a new vehicle for the infantry that can navigate difficult terrain.&lt;/example&gt;
&lt;example&gt;Research and compare different design bureaus to find one that aligns with your project goals.&lt;/example&gt;
&lt;example&gt;How can machine learning be used to improve customer service in the retail industry?&lt;/example&gt;
&lt;example&gt;Create a nutrition plan for an infantry soldier to optimize their performance in the field.&lt;/example&gt;
&lt;example&gt;What are some best practices for designing a logo for a new brand?&lt;/example&gt;
&lt;example&gt;Implement a machine learning algorithm to predict customer churn for a telecommunications company.&lt;/example&gt;
&lt;example&gt;Develop a training program for infantry soldiers to improve their communication and teamwork skills.&lt;/example&gt;
&lt;example&gt;What are some challenges that arise when designing for virtual reality?&lt;/example&gt;
&lt;example&gt;Find a design bureau that specializes in creating interactive exhibits for museums.&lt;/example&gt;
&lt;example&gt;How can machine learning be used to improve fraud detection in the financial industry?&lt;/example&gt;
&lt;example&gt;Design a new piece of equipment for the infantry that can be used in urban environments.&lt;/example&gt;</code></pre>
<p>Some key things to note just from the small sample above, instructions like <em>“Design a new piece of equipment for the infantry that can be used in urban environments”, “Research and compare different design bureaus to find one that aligns with your project goals”</em> are noisy. This hints that the 2.65M generated instructions might be noisy too.</p>
</section>
<section id="response-generation" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="response-generation"><span class="header-section-number">2.3</span> Response Generation</h3>
<p>Let’s collate the above instructions and generate responses for each one to create the resulting pairs.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>It has not been shared in the research paper as to how the responses were generated. In this blog post, I am assuming that the authors used <code>openai.ChatCompletion</code> to get responses for each example.</p>
</div>
</div>
<p>Let’s take a simple example to generate a <code>.jsonl</code> type <code>dataset</code> as below.</p>
<div class="cell" data-execution_count="70">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> defaultdict(<span class="bu">dict</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>instructions <span class="op">=</span> [</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;example&gt;What are some common machine learning algorithms and their applications?&lt;/example&gt;"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;example&gt;Design a new weapon for the infantry that is both effective and lightweight.&lt;/example&gt;"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;example&gt;Retrieve the contact information for a design bureau specializing in sustainable architecture.&lt;/example&gt;"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;example&gt;How can machine learning be used to improve healthcare outcomes?&lt;/example&gt;"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt;example&gt;Create a workout plan for an infantry soldier to improve their endurance and strength.&lt;/example&gt;"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, inst <span class="kw">in</span> <span class="bu">enumerate</span>(instructions):    </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    prompt <span class="op">=</span> <span class="ss">f"""Given the following instruction separated by `&lt;example&gt;`, generate a response.</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="ss">    Response must start with the label "&lt;response&gt;" and end with the label "&lt;/response&gt;".</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="ss">    Instruction: </span><span class="sc">{</span>inst<span class="sc">}</span><span class="ss">    </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="ss">    """</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    messages <span class="op">=</span> [{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: prompt}]</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> openai.ChatCompletion.create(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        model<span class="op">=</span><span class="st">'gpt-3.5-turbo'</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        messages<span class="op">=</span>messages,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        temperature<span class="op">=</span><span class="dv">0</span>, <span class="co"># not specified in the paper </span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    dataset[idx] <span class="op">=</span> {<span class="st">'prompt'</span>: inst, <span class="st">'completion'</span>:response.choices[<span class="dv">0</span>].message[<span class="st">"content"</span>]}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Running above code will give us a dataset that can be used to finetune the base models using OpenAI. This dataset looks something like:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>defaultdict(<span class="bu">dict</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>            {<span class="dv">0</span>: {<span class="st">'prompt'</span>: <span class="st">'&lt;example&gt;What are some common machine learning algorithms and their applications?&lt;/example&gt;'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'completion'</span>: <span class="st">'&lt;response&gt;Some common machine learning algorithms and their applications include: </span><span class="ch">\n</span><span class="st">- Linear Regression: used for predicting numerical values</span><span class="ch">\n</span><span class="st">- Logistic Regression: used for classification problems</span><span class="ch">\n</span><span class="st">- Decision Trees: used for both classification and regression problems</span><span class="ch">\n</span><span class="st">- Random Forest: used for classification, regression, and feature selection</span><span class="ch">\n</span><span class="st">- Support Vector Machines: used for classification and regression problems</span><span class="ch">\n</span><span class="st">- K-Nearest Neighbors: used for classification and regression problems</span><span class="ch">\n</span><span class="st">- Neural Networks: used for complex problems such as image recognition and natural language processing&lt;/response&gt;'</span>},</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span>: {<span class="st">'prompt'</span>: <span class="st">'&lt;example&gt;Design a new weapon for the infantry that is both effective and lightweight.&lt;/example&gt;'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">'completion'</span>: <span class="st">'&lt;response&gt;A possible solution for a new weapon for the infantry that is both effective and lightweight could be a compact assault rifle that uses advanced materials and technology to reduce weight without sacrificing firepower. The rifle could have a modular design that allows for easy customization and upgrades, and could also incorporate features such as a suppressor and a holographic sight for improved accuracy. Additionally, the rifle could be designed to be easily disassembled and reassembled for maintenance and cleaning in the field.&lt;/response&gt;'</span>},</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>: {<span class="st">'prompt'</span>: <span class="st">'&lt;example&gt;Retrieve the contact information for a design bureau specializing in sustainable architecture.&lt;/example&gt;'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">'completion'</span>: <span class="st">'&lt;response&gt;Here is the contact information for a design bureau specializing in sustainable architecture:&lt;/response&gt;'</span>},</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span>: {<span class="st">'prompt'</span>: <span class="st">'&lt;example&gt;How can machine learning be used to improve healthcare outcomes?&lt;/example&gt;'</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">'completion'</span>: <span class="st">'&lt;response&gt;Machine learning can be used to improve healthcare outcomes by analyzing large amounts of patient data to identify patterns and predict potential health issues. This can lead to earlier diagnosis and treatment, as well as personalized treatment plans based on individual patient characteristics. Additionally, machine learning can help healthcare providers identify patients who are at risk for readmission or complications, allowing for targeted interventions to improve outcomes and reduce costs.&lt;/response&gt;'</span>},</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>             <span class="dv">4</span>: {<span class="st">'prompt'</span>: <span class="st">'&lt;example&gt;Create a workout plan for an infantry soldier to improve their endurance and strength.&lt;/example&gt;'</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">'completion'</span>: <span class="st">'&lt;response&gt;Here is a workout plan for an infantry soldier to improve their endurance and strength:&lt;/response&gt;</span><span class="ch">\n</span><span class="st">- Warm up: 5-10 minutes of light cardio (jogging, jumping jacks, etc.)</span><span class="ch">\n</span><span class="st">- Circuit 1: 3 rounds of the following exercises with minimal rest in between:</span><span class="ch">\n</span><span class="st">  - 20 push-ups</span><span class="ch">\n</span><span class="st">  - 20 squats</span><span class="ch">\n</span><span class="st">  - 20 lunges (10 per leg)</span><span class="ch">\n</span><span class="st">  - 1-minute plank</span><span class="ch">\n</span><span class="st">- Circuit 2: 3 rounds of the following exercises with minimal rest in between:</span><span class="ch">\n</span><span class="st">  - 20 burpees</span><span class="ch">\n</span><span class="st">  - 20 jumping jacks</span><span class="ch">\n</span><span class="st">  - 20 mountain climbers (10 per leg)</span><span class="ch">\n</span><span class="st">  - 1-minute wall sit</span><span class="ch">\n</span><span class="st">- Circuit 3: 3 rounds of the following exercises with minimal rest in between:</span><span class="ch">\n</span><span class="st">  - 20 dumbbell rows (10 per arm)</span><span class="ch">\n</span><span class="st">  - 20 dumbbell curls (10 per arm)</span><span class="ch">\n</span><span class="st">  - 20 dumbbell overhead presses (10 per arm)</span><span class="ch">\n</span><span class="st">  - 1-minute rest</span><span class="ch">\n</span><span class="st">- Cool down: 5-10 minutes of stretching and foam rolling.'</span>}})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dataset-exploration" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="dataset-exploration"><span class="header-section-number">3</span> Dataset Exploration</h2>
<p>In the last section I shared how the dataset generation looks like for <code>LaMini-LM</code>. In this section we will explore the 2.58M instruction dataset. The dataset has been shared publicly and is available <a href="https://huggingface.co/datasets/MBZUAI/LaMini-instruction/viewer/mbzuai-distil--instruction/train">here</a>.</p>
<div id="fig-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../images/lamini-dataset-stats.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Data statistics of the generated dataset.</figcaption><p></p>
</figure>
</div>
<p>As can be seen aboce, in total there are 2.58M samples in <code>LaMini-LM</code>. It can be observed that the instructions for <span class="math inline">\(D_{P3}\)</span> &amp; <span class="math inline">\(D_{FLAN}\)</span> are in general longer compared to the rest. As part of this section we will be exploring some samples from each dataset.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datasets <span class="im">import</span> load_dataset, load_dataset_builder</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ds_builder <span class="op">=</span> load_dataset_builder(<span class="st">"MBZUAI/LaMini-instruction"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ds_builder.info.features</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>{'instruction': Value(dtype='string', id=None),
 'response': Value(dtype='string', id=None)}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> load_dataset(<span class="st">"MBZUAI/LaMini-instruction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7cbdfc74bccd4f3da43be24897696547","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ddc3bbf8e78246b3bd0f5d14f963df7f","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading and preparing dataset json/chatGPT_distil (download: 681.47 MiB, generated: 1.04 GiB, post-processed: Unknown size, total: 1.70 GiB) to /home/ubuntu/.cache/huggingface/datasets/MBZUAI___parquet/mbzuai-distil--instruction-bc3e4bc26f941475/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec...</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4ba3e2bc430442fbae53b8f9386fa712","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"66e138a129c449d9bf6819c3a601bc8d","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cee333c7c15c4476bdf13c13f00770e2","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"09a27e8e4ffe44abb0ab781e9f960dc0","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2e64f6ddce46480280aa53dfd9a7e88c","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Dataset parquet downloaded and prepared to /home/ubuntu/.cache/huggingface/datasets/MBZUAI___parquet/mbzuai-distil--instruction-bc3e4bc26f941475/0.0.0/2a3b91fbd88a2c90d1dbbb32b460cf621d31bd5b05b934492fdef7d8d6f236ec. Subsequent calls will reuse this data.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5daf6a1a4a0e47e081c150cda2570a53","version_major":2,"version_minor":0}
</script>
</div>
</div>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>DatasetDict({
    train: Dataset({
        features: ['instruction', 'response'],
        num_rows: 2582019
    })
})</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> pd.Series(dataset[<span class="st">'train'</span>][<span class="st">'instruction'</span>]).sample(<span class="dv">5000</span>, random_state<span class="op">=</span><span class="dv">123</span>).values</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sentences[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array(['Given that Calendar » American Heart Association- Go Red For Women Luncheon February 27, 2015 from 10:30am - 1:00pm The Go Red For Women Luncheon is an event to raise funds for research and initiatives preventing heart disease and stroke. The luncheon is the American Heart Association\'s annual event to increase awareness of heart disease- the No. 1 cause of death for women- and inspire women to take charge of their health. Therefore, it must be true that "these initiatives don\'t prevent heart disease and strokes"? Yes, no, or maybe?',
       'If someone is wearing a winter coat outside, does it logically follow that it is cold?\n\nOPTIONS:\n- yes\n- it is not possible to tell\n- no',
       'A small force was left in Cibola and the expedition moved on to a town which originally had been founded by Cabeza de Vaca\n\nCould you correct the punctuation please?',
       'Explain the process of photosynthesis.',
       'What is Esperanto, and who created it?'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> SentenceTransformer(<span class="st">'all-mpnet-base-v2'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>sentence_embeddings <span class="op">=</span> model.encode(sentences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"54787c16f6dd4f7486f4326a85d4209d","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b4d97b72f12242ed9cb82097aa79a5b2","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bc2975f3b87448b7a2b97f7926583f5f","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d41d8c67b37147d8984e514bcd2d1259","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1a457f1e60e74847a644b2e0fc3698c0","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"10acd72bd1644428964419ed8ed46139","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2557f02800a34b7db8e31b65011e3dbe","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5c8429da59c14a3f81a77018bd352594","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"39f6f0431ece4f3a8901c747da458800","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"658940e09d73453c8667a39fcd28b165","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d4cd6395c58e41b1b02275cd0e59ba53","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"682d8a45fd7b4da2ab86ec8078825cb6","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b2b4bc0b69b549fbb4e0669e91c5e30f","version_major":2,"version_minor":0}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2bb42c320cdd4ba0b56feca372c7c928","version_major":2,"version_minor":0}
</script>
</div>
</div>



</section>

<link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css"><div id="mc_embed_signup">
    <form action="https://github.us4.list-manage.com/subscribe/post?u=e847230346a7c78d4745ae796&amp;id=7a63b2b273&amp;f_id=005f58e8f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
        <div id="mc_embed_signup_scroll">
        <h2 class="anchored">Subscribe to Aman Arora's blog:</h2>
        <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
<div class="mc-field-group">
    <label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
</label>
    <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required="">
    <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
</div>
<div hidden="true"><input type="hidden" name="tags" value="7232948"></div>
    <div id="mce-responses" class="clear foot">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_e847230346a7c78d4745ae796_7a63b2b273" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot">
                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                <p class="brandingLogo"><a href="http://eepurl.com/il3baM" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
            </div>
        </div>
    </div>
</form>
</div><script type="text/javascript">(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-flan" class="csl-entry" role="doc-biblioentry">
Longpre, Shayne, Le Hou, Tu Vu, Albert Webson, Hyung Won Chung, Yi Tay, Denny Zhou, et al. 2023. <span>“The Flan Collection: Designing Data and Methods for Effective Instruction Tuning.”</span> <a href="https://arxiv.org/abs/2301.13688">https://arxiv.org/abs/2301.13688</a>.
</div>
<div id="ref-p3" class="csl-entry" role="doc-biblioentry">
Sanh, Victor, Albert Webson, Colin Raffel, Stephen H. Bach, Lintang Sutawika, Zaid Alyafeai, Antoine Chaffin, et al. 2021. <span>“Multitask Prompted Training Enables Zero-Shot Task Generalization.”</span> <a href="https://arxiv.org/abs/2110.08207">https://arxiv.org/abs/2110.08207</a>.
</div>
<div id="ref-alpaca" class="csl-entry" role="doc-biblioentry">
Taori, Rohan, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. 2023. <span>“Stanford Alpaca: An Instruction-Following LLaMA Model.”</span> <em>GitHub Repository</em>. <a href="https://github.com/tatsu-lab/stanford_alpaca" class="uri">https://github.com/tatsu-lab/stanford_alpaca</a>; GitHub.
</div>
<div id="ref-selfinstruct" class="csl-entry" role="doc-biblioentry">
Wang, Yizhong, Yeganeh Kordi, Swaroop Mishra, Alisa Liu, Noah A. Smith, Daniel Khashabi, and Hannaneh Hajishirzi. 2022. <span>“Self-Instruct: Aligning Language Model with Self Generated Instructions.”</span> <a href="https://arxiv.org/abs/2212.10560">https://arxiv.org/abs/2212.10560</a>.
</div>
<div id="ref-laminilm" class="csl-entry" role="doc-biblioentry">
Wu, Minghao, Abdul Waheed, Chiyu Zhang, Muhammad Abdul-Mageed, and Alham Fikri Aji. 2023. <span>“LaMini-LM: A Diverse Herd of Distilled Models from Large-Scale Instructions.”</span> <a href="https://arxiv.org/abs/2304.14402">https://arxiv.org/abs/2304.14402</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>